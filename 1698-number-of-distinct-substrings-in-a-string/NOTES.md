Solve it in O(nlogn) using suffix array and lcp